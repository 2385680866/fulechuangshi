;(function(){var _instanceList={};function imageSlider(root,options){this.root=root;this.$bigPicBox=$(this.root).find('.pic');this.$bigPicItems=this.$bigPicBox.find('li');this.$bigPicLink=this.$bigPicBox.find('a');this.bigPicCount=this.$bigPicBox.find('img').length;this.$txtItems=null;this.$thumbItems=null;this.currentPicIndex=0;this.options=$.extend({'auto':false,'slideInterval':5000,'renderMode':2},options||{});return this;}
imageSlider.prototype={init:function(){if(this.options.renderMode===1){this.render();}else{this.$txtItems=$(this.root).find('.txt li');this.$thumbItems=$(this.root).find('.thumb li');this.bindEvent();}},render:function(){this.renderTxt();this.renderThumb();this.renderBtn();this.bindEvent();this.root.className='mF_games_tb mF_games_tb_myFocus';$(this.$bigPicBox).css({'width':'566px','height':'328px','overflow':'hidden'});$(this.root).css({'visibility':'visible','height':'414px'});this.showBigPic(this.currentPicIndex);var me=this;if(this.options.auto){setInterval(function(){me.currentPicIndex=me.currentPicIndex+1<me.bigPicCount?me.currentPicIndex+1:0;me.showBigPic(me.currentPicIndex);},this.options.slideInterval);}},renderTxt:function(){var $box=$('<div class="txt">'),$ul=$('<ul>');this.$bigPicLink.each(function(){var $bigPicLink=$(this),$bigPic=$bigPicLink.find('img'),$li=$('<li style="bottom:86px;">'),$a=$('<a>'),$p=$('<p>');$a.attr({'href':$bigPicLink.attr('href'),'target':$bigPicLink.attr('target'),'title':$bigPicLink.attr('title'),'alt':$bigPicLink.attr('alt')}).text($bigPic.attr('alt'));$p.text($bigPic.attr('text'));$li.append($a).append($p);$ul.append($li);});$box.append($ul);$(this.root).append($box);this.$txtItems=$(this.root).find('.txt li');},renderThumb:function(){var $box=$('<div class="thumb" style="width: 526px; height: 86px; left: 20px;">'),$ul=$('<ul style="width: 525px; left: 0px;">');this.$bigPicLink.each(function(){var $bigPicLink=$(this),$bigPic=$bigPicLink.find('img'),$li=$('<li style="width:105px;">'),$a=$('<a>'),$img=$('<img style="height: 60px;">');var thumb=$bigPic.attr('thumb'),imgUrl=thumb?thumb:$bigPic.attr('src'),imgTitle=$bigPic.attr('title'),imgAlt=$bigPic.attr('alt');$img.attr({'src':imgUrl,'title':imgTitle,'alt':imgAlt});$a.append($img);$li.append($a);$ul.append($li);});$box.append($ul);$(this.root).append($box);this.$thumbItems=$(this.root).find('.thumb li');},renderBtn:function(){var $prevBtn=$('<div class="prev_focus"><a class="gray2" href="javascript:;">‹</a></div>'),$nextBtn=$('<div class="next_focus"><a class="gray2" href="javascript:;">›</a></div>');$(this.root).append($prevBtn).append($nextBtn);},bindEvent:function(){var me=this;$(this.root).find('.prev_focus a').on('click',function(){me.currentPicIndex=me.currentPicIndex-1>=0?me.currentPicIndex-1:me.bigPicCount-1;me.showBigPic(me.currentPicIndex);return false;});$(this.root).find('.next_focus a').on('click',function(){me.currentPicIndex=me.currentPicIndex+1<me.bigPicCount?me.currentPicIndex+1:0;me.showBigPic(me.currentPicIndex);return false;});this.$thumbItems.on('mouseover',function(event){event.preventDefault();me.currentPicIndex=me.$thumbItems.index(this);me.showBigPic(me.currentPicIndex);});},showBigPic:function(index){this.$bigPicItems.eq(index).fadeIn('slow').siblings('li').fadeOut('slow');this.$txtItems.eq(index).show().siblings('li').hide();this.$thumbItems.eq(index).addClass('current').siblings('li').removeClass('current');}};function _getRandomKey(){return Math.round(Math.random()*99999999);}
$.fn.imageSliderByThumb=function(options){return this.each(function(){if(!_instanceList[$(this).attr('imageSliderByThumb')]){var instanceKey=_getRandomKey(),instance=new imageSlider(this,options);instance.init();_instanceList[instanceKey]=instance;$(this).attr('imageSliderByThumb',instanceKey);}});};})(jQuery);;(function(){var _instanceList={};function imageSlider(root,options){this.root=root;this.$bigPicBox=$(this.root).find('.pic');this.$bigPicItems=this.$bigPicBox.find('li');this.$bigPicLink=this.$bigPicBox.find('a');this.bigPicCount=this.$bigPicBox.find('img').length;this.$txtItems=null;this.$numBtnItems=null;this.currentPicIndex=0;this.options=$.extend({'auto':false,'slideInterval':5000},options||{});return this;}
imageSlider.prototype={init:function(){this.render();},render:function(){this.renderTxt();this.renderNumBtn();this.renderTxtBg();this.bindEvent();this.root.className='girl_focus mF_expo2010 mF_expo2010_girlFocus';$(this.$bigPicBox).css({'position':'relative','width':'520px','height':'184px','overflow':'hidden'});$(this.root).css({'visibility':'visible','overflow':'hidden'});this.showBigPic(this.currentPicIndex);var me=this;if(this.options.auto){setInterval(function(){me.currentPicIndex=me.currentPicIndex+1<me.bigPicCount?me.currentPicIndex+1:0;me.showBigPic(me.currentPicIndex);},this.options.slideInterval);}},renderTxt:function(){var $box=$('<div class="txt">'),$ul=$('<ul>');this.$bigPicLink.each(function(){var $bigPicLink=$(this),$bigPic=$bigPicLink.find('img'),$li=$('<li style="bottom:-36px; width:520px; height:36px; overflow:hidden;">'),$a=$('<a>'),$p=$('<p>'),$b=$('<b>');$a.attr({'href':$bigPicLink.attr('href'),'target':$bigPicLink.attr('target')}).text($bigPic.attr('alt'));$p.text($bigPic.attr('text'));$li.append($a).append($p).append($b);$ul.append($li);});$box.append($ul);$(this.root).append($box);this.$txtItems=$(this.root).find('.txt li');},renderNumBtn:function(){var $box=$('<div class="num">'),$ul=$('<ul>');this.$bigPicLink.each(function(index,item){var $bigPicLink=$(item),$bigPic=$bigPicLink.find('img'),$li=$('<li>'),$a=$('<a>'),$b=$('<b>');$a.text(index+1);$li.append($a).append($b);$ul.append($li);});$box.append($ul);$(this.root).append($box);this.$numBtnItems=$(this.root).find('.num li');},renderTxtBg:function(){var $txtBg=$('<div class="txt_bg">');$(this.root).append($txtBg);},bindEvent:function(){var me=this;this.$numBtnItems.on('mouseover','a',function(event){me.currentPicIndex=parseInt($(this).text(),10)-1;me.showBigPic(me.currentPicIndex);return false;});},showBigPic:function(index){this.$bigPicItems.eq(index).fadeIn('slow').siblings('li').fadeOut('slow');this.$txtItems.eq(index).animate({'bottom':0},400).siblings('li').css('bottom','-36px');this.$numBtnItems.eq(index).addClass('current').siblings('li').removeClass('current');}};function _getRandomKey(){return Math.round(Math.random()*99999999);}
$.fn.imageSliderByNum=function(options){return this.each(function(){if(!_instanceList[$(this).attr('imageSliderByNum')]){var instanceKey=_getRandomKey(),instance=new imageSlider(this,options);instance.init();_instanceList[instanceKey]=instance;$(this).attr('imageSliderByNum',instanceKey);}});};})(jQuery);;(function($){$.fn.kxbdSuperMarquee=function(options){var opts=$.extend({},$.fn.kxbdSuperMarquee.defaults,options);return this.each(function(){var $marquee=$(this);var _scrollObj=$marquee.get(0);var scrollW=$marquee.width();var scrollH=$marquee.height();var $element=$marquee.children();var $kids=$element.children();var scrollSize=opts.scrollSize;var _type=(opts.direction=='left'||opts.direction=='right')?1:0;var scrollId,rollId,isMove,marqueeId;var t,b,c,d,e;var _size,_len;var $nav,$navBtns;var arrPos=[];var numView=0;var numRoll=0;var numMoved=0;$element.css(_type?'width':'height',10000);var navHtml='<ul>';if(opts.isEqual){_size=$kids[_type?'outerWidth':'outerHeight']();_len=$kids.length;if(scrollSize===0){scrollSize=_size*_len;}
for(var i=0;i<_len;i++){arrPos.push(i*_size);navHtml+='<li>'+(i+1)+'</li>';}}else{scrollSize=0;$kids.each(function(i){arrPos.push(scrollSize);scrollSize+=$(this)[_type?'outerWidth':'outerHeight']();navHtml+='<li>'+(i+1)+'</li>';});}
navHtml+='</ul>';if(scrollSize<(_type?scrollW:scrollH))return;$element.append($kids.clone()).css(_type?'width':'height',scrollSize*2);if(opts.navId){$nav=$(opts.navId).append(navHtml).hover(stop,start);$navBtns=$('li',$nav);$navBtns.each(function(i){$(this).bind(opts.eventNav,function(){if(isMove)return;if(numView==i)return;rollFunc(arrPos[i]);$navBtns.eq(numView).removeClass('navOn');numView=i;$(this).addClass('navOn');});});$navBtns.eq(numView).addClass('navOn');}
if(opts.direction=='right'||opts.direction=='down'){_scrollObj[_type?'scrollLeft':'scrollTop']=scrollSize;}else{_scrollObj[_type?'scrollLeft':'scrollTop']=0;}
if(opts.isMarquee){marqueeId=setTimeout(scrollFunc,opts.scrollDelay);$marquee.hover(function(){clearInterval(marqueeId);},function(){clearInterval(marqueeId);marqueeId=setTimeout(scrollFunc,opts.scrollDelay);});if(opts.controlBtn){$.each(opts.controlBtn,function(i,val){$(val).bind(opts.eventA,function(){opts.direction=i;opts.oldAmount=opts.scrollAmount;opts.scrollAmount=opts.newAmount;}).bind(opts.eventB,function(){opts.scrollAmount=opts.oldAmount;});});}}else{if(opts.isAuto){start();$marquee.hover(stop,start);}
if(opts.btnGo){$.each(opts.btnGo,function(i,val){$(val).bind(opts.eventGo,function(){if(isMove===true)return;opts.direction=i;rollFunc();if(opts.isAuto){stop();start();}});});}}
function scrollFunc(){var _dir=(opts.direction=='left'||opts.direction=='right')?'scrollLeft':'scrollTop',newPos=0;if(opts.isMarquee){if(opts.loop>0){numMoved+=opts.scrollAmount;if(numMoved>scrollSize*opts.loop){_scrollObj[_dir]=0;return clearInterval(marqueeId);}}
newPos=_scrollObj[_dir]+(opts.direction=='left'||opts.direction=='up'?1:-1)*opts.scrollAmount;}else{if(opts.duration){if(t++<d){isMove=true;newPos=Math.ceil(easeOutQuad(t,b,c,d));if(t==d){newPos=e;}}else{newPos=e;clearInterval(scrollId);isMove=false;return;}}else{newPos=e;clearInterval(scrollId);}}
if(opts.direction=='left'||opts.direction=='up'){if(newPos>=scrollSize){newPos-=scrollSize;}}else{if(newPos<=0){newPos+=scrollSize;}}
_scrollObj[_dir]=newPos;if(opts.isMarquee){marqueeId=setTimeout(scrollFunc,opts.scrollDelay);}else if(t<d){if(scrollId)clearTimeout(scrollId);scrollId=setTimeout(scrollFunc,opts.scrollDelay);}else{isMove=false;}}
function rollFunc(pPos){isMove=true;var _dir=(opts.direction=='left'||opts.direction=='right')?'scrollLeft':'scrollTop';var _neg=opts.direction=='left'||opts.direction=='up'?1:-1;numRoll=numRoll+_neg;if(pPos===undefined&&opts.navId){$navBtns.eq(numView).removeClass('navOn');numView+=_neg;if(numView>=_len){numView=0;}else if(numView<0){numView=_len-1;}
$navBtns.eq(numView).addClass('navOn');numRoll=numView;}
var _temp=numRoll<0?scrollSize:0;t=0;b=_scrollObj[_dir];e=(pPos!==undefined)?pPos:_temp+(opts.distance*numRoll)%scrollSize;if(_neg==1){if(e>b){c=e-b;}else{c=e+scrollSize-b;}}else{if(e>b){c=e-scrollSize-b;}else{c=e-b;}}
d=opts.duration;if(scrollId)clearTimeout(scrollId);scrollId=setTimeout(scrollFunc,opts.scrollDelay);}
function start(){rollId=setInterval(function(){rollFunc();},opts.time*1000);}
function stop(){clearInterval(rollId);}
function easeOutQuad(t,b,c,d){return-c*(t/=d)*(t-2)+b;}
function easeOutQuint(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b;}});};$.fn.kxbdSuperMarquee.defaults={isMarquee:false,scrollSize:0,isEqual:true,loop:0,newAmount:3,eventA:'mousedown',eventB:'mouseup',isAuto:true,time:5,duration:50,eventGo:'click',direction:'left',scrollAmount:1,scrollDelay:10,eventNav:'click'};$.fn.kxbdSuperMarquee.setDefaults=function(settings){$.extend($.fn.kxbdSuperMarquee.defaults,settings);};})(jQuery);
/* Lazy Load 1.9.3 - MIT license - Copyright 2010-2013 Mika Tuupola */
!function(a,b,c,d){var e=a(b);a.fn.lazyload=function(f){function g(){var b=0;i.each(function(){var c=a(this);if(!j.skip_invisible||c.is(":visible"))if(a.abovethetop(this,j)||a.leftofbegin(this,j));else if(a.belowthefold(this,j)||a.rightoffold(this,j)){if(++b>j.failure_limit)return!1}else c.trigger("appear"),b=0})}var h,i=this,j={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return f&&(d!==f.failurelimit&&(f.failure_limit=f.failurelimit,delete f.failurelimit),d!==f.effectspeed&&(f.effect_speed=f.effectspeed,delete f.effectspeed),a.extend(j,f)),h=j.container===d||j.container===b?e:a(j.container),0===j.event.indexOf("scroll")&&h.bind(j.event,function(){return g()}),this.each(function(){var b=this,c=a(b);b.loaded=!1,(c.attr("src")===d||c.attr("src")===!1)&&c.is("img")&&c.attr("src",j.placeholder),c.one("appear",function(){if(!this.loaded){if(j.appear){var d=i.length;j.appear.call(b,d,j)}a("<img />").bind("load",function(){var d=c.attr("data-"+j.data_attribute);c.hide(),c.is("img")?c.attr("src",d):c.css("background-image","url('"+d+"')"),c[j.effect](j.effect_speed),b.loaded=!0;var e=a.grep(i,function(a){return!a.loaded});if(i=a(e),j.load){var f=i.length;j.load.call(b,f,j)}}).attr("src",c.attr("data-"+j.data_attribute))}}),0!==j.event.indexOf("scroll")&&c.bind(j.event,function(){b.loaded||c.trigger("appear")})}),e.bind("resize",function(){g()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&e.bind("pageshow",function(b){b.originalEvent&&b.originalEvent.persisted&&i.each(function(){a(this).trigger("appear")})}),a(c).ready(function(){g()}),this},a.belowthefold=function(c,f){var g;return g=f.container===d||f.container===b?(b.innerHeight?b.innerHeight:e.height())+e.scrollTop():a(f.container).offset().top+a(f.container).height(),g<=a(c).offset().top-f.threshold},a.rightoffold=function(c,f){var g;return g=f.container===d||f.container===b?e.width()+e.scrollLeft():a(f.container).offset().left+a(f.container).width(),g<=a(c).offset().left-f.threshold},a.abovethetop=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollTop():a(f.container).offset().top,g>=a(c).offset().top+f.threshold+a(c).height()},a.leftofbegin=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollLeft():a(f.container).offset().left,g>=a(c).offset().left+f.threshold+a(c).width()},a.inviewport=function(b,c){return!(a.rightoffold(b,c)||a.leftofbegin(b,c)||a.belowthefold(b,c)||a.abovethetop(b,c))},a.extend(a.expr[":"],{"below-the-fold":function(b){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-screen":function(b){return a.rightoffold(b,{threshold:0})},"left-of-screen":function(b){return!a.rightoffold(b,{threshold:0})},"in-viewport":function(b){return a.inviewport(b,{threshold:0})},"above-the-fold":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-fold":function(b){return a.rightoffold(b,{threshold:0})},"left-of-fold":function(b){return!a.rightoffold(b,{threshold:0})}})}(jQuery,window,document);;(function($){var _util=CS.util,_dialog=CS.dialog;var _nodes={},_searchUrl='',_defaultInputValue="书名",_searchTypeHoverCss='';function init(searchUrl,searchTypeHoverCss){_searchUrl=searchUrl;if(searchTypeHoverCss){_searchTypeHoverCss=searchTypeHoverCss;}
_nodes={'searchInput':$('#searchInput'),'searchTypeBox':$('#searchTypeBox'),'searchType':$('#searchType'),'searchTypeDropdown':$('#searchTypeDropdown'),'searchBtn':$('#searchBtn')};_bindEvent();}
function _bindEvent(){var $showSearchTypeDropdownBtn=_nodes.searchTypeBox.length>0?_nodes.searchTypeBox:_nodes.searchType;$showSearchTypeDropdownBtn.hover(_showSearchTypeDropdown,_hideSearchTypeDropdown);_nodes.searchTypeDropdown.hover(_showSearchTypeDropdown,_hideSearchTypeDropdown);_nodes.searchTypeDropdown.find('a').on('click',function(){_nodes.searchType.html($(this).html()).attr('type',$(this).attr('type'));_nodes.searchTypeDropdown.hide();});_nodes.searchBtn.on('click',_openSearchPage);_nodes.searchInput.on('keyup',function(event){if(event.keyCode===13){return _openSearchPage();}});var defaultInputValue=_nodes.searchInput.attr("def");if(defaultInputValue){_nodes.searchInput.on('focus',function(){var $this=$(this);if($this.val()===defaultInputValue){$this.val('');}}).on('blur',function(){var $this=$(this);if($this.val()===''){$this.val(defaultInputValue);}});}}
function _showSearchTypeDropdown(){if(_searchTypeHoverCss&&!_nodes.searchType.hasClass(_searchTypeHoverCss)){_nodes.searchType.addClass(_searchTypeHoverCss);}
_nodes.searchTypeDropdown.show();}
function _hideSearchTypeDropdown(){if(_searchTypeHoverCss){_nodes.searchType.removeClass(_searchTypeHoverCss);}
_nodes.searchTypeDropdown.hide();}
function _openSearchPage(){var search_type=_nodes.searchType.attr('type'),search_value=$.trim(_nodes.searchInput.val());if(search_value.length===0||search_value===_util.sim2tra(_defaultInputValue)){_dialog.alert("请输入搜索内容");return false;}
var ref=_searchUrl.replace('p1',search_type).replace('p2',search_value);window.open(ref);return false;}
CS.util.initNameSpace("CS.searchInput");CS.searchInput={"init":init};})(jQuery);;(function($){var _util=CS.util;var _nodes={},_fixedRight=0;function init(){_nodes.$fixedRight=$('#fixedRight');_fixedRight=_nodes.$fixedRight.offset();_bindEvent();}
function _bindEvent(){$(window).scroll(function(){_util.throttle(_scrollHandler);});$("#fixedRight_closeBtn").click(function(){_nodes.$fixedRight.hide();});}
function _scrollHandler(){var offsetTop=_fixedRight.top+$(window).scrollTop()+"px";_nodes.$fixedRight.animate({top:offsetTop},{duration:500,queue:false});}
_util.initNameSpace("CS");CS.qqReadAd={'init':init};})(jQuery);﻿;(function($j){$j.positionFixed=function(el){$j(el).each(function(){new fixed(this);});return el;};$j.fn.positionFixed=function(){return $j.positionFixed(this);}
var fixed=$j.positionFixed.impl=function(el){var o=this;o.sts={target:$j(el).css('position','fixed'),container:$j(window)}
o.sts.currentCss={top:o.sts.target.css('top'),right:o.sts.target.css('right'),bottom:o.sts.target.css('bottom'),left:o.sts.target.css('left')}
if(!o.ie6){return;}
o.bindEvent();}
$j.extend(fixed.prototype,{ie6:!!window.ActiveXObject&&!window.XMLHttpRequest,bindEvent:function(){var o=this;o.sts.target.css('position','absolute');o.overRelative().initBasePos();o.sts.target.css(o.sts.basePos);o.sts.container.scroll(o.scrollEvent()).resize(o.resizeEvent());o.setPos();},overRelative:function(){var o=this;var relative=o.sts.target.parents().filter(function(){if($j(this).css('position')==='relative'){return this;}});if(relative.size()>0){relative.after(o.sts.target);}
return o;},initBasePos:function(){var o=this;o.sts.basePos={top:o.sts.target.offset().top-(o.sts.currentCss.top==='auto'?o.sts.container.scrollTop():0),left:o.sts.target.offset().left-(o.sts.currentCss.left==='auto'?o.sts.container.scrollLeft():0)};return o;},setPos:function(){var o=this;o.sts.target.css({top:o.sts.container.scrollTop()+o.sts.basePos.top,left:o.sts.container.scrollLeft()+o.sts.basePos.left});},scrollEvent:function(){var o=this;return function(){o.setPos();};},resizeEvent:function(){var o=this;return function(){setTimeout(function(){o.sts.target.css(o.sts.currentCss);o.initBasePos();o.setPos();},1);};}})})(jQuery);;(function($){function _close(fn){if(typeof fn==="function"){fn();}}
$.fn.popWin=function(options){var defaultConfig={popupSelector:"",closeSelector:"",closeCallback:function(){},slideTime:600};var options=$.extend(defaultConfig,options);var noie6=!(!!window.ActiveXObject&&!window.XMLHttpRequest&&!$.support.style);var $popup=$(options.popupSelector),$closeBtn=$(options.closeSelector),closeCallback=options.closeCallback,slideTime=options.slideTime;$closeBtn.off("click");if(noie6){$popup.slideDown(slideTime);$closeBtn.on("click",function(){$popup.slideUp(slideTime);_close(closeCallback);});}else{$popup.fadeIn(slideTime);$closeBtn.on("click",function(){$popup.fadeOut(slideTime);_close(closeCallback);});}}})(jQuery);﻿;(function($){var _util=CS.util,_uiBinder=CS.uiBinder,_dialog=CS.dialog,_bookshelf=CS.bookshelf;var _params={},_nodes={};var _bookPopup={dataList:{},isLoading:0,isAllowHide:1,setTimeoutByOpen:null,setTimeoutByClose:null,openTimeout:200,closeTimeout:200,nodes:null};var _recommendList={'week':[],'girl':[]},_boutiqueList=[];var _isChanging={'qiangtui':0,'boutique':0};var _bookInfoPopupTpl=['<div attr="inner:popup;" class="bookInfoPopup" style="position:absolute; z-index:100; display:none;">','<div class="bookDataBox cf">','<a attr="inner:bookLink;" href="javascript:" target="_blank">','<img attr="inner:bookCover;" width="62" height="77">','</a>','<div class="bookDataInfo">','<h3><a attr="inner:bookNameLink;" href="javascript:" target="_blank"></a></h3>','<p>作者：<a attr="inner:authorNameLink;" href="javascript:" target="_blank"></a></p>','<p>总人气：<span attr="inner:popularValue;"></span></p>','<p>最新章节：<span attr="inner:lastChapterName;"></span></p>','</div>','<p class="intro">','<span class="gray2">简介：</span>','<em attr="inner:bookDesc;"></em>','</p>','</div>','<p class="btn">','<a attr="inner:readLink;" class="blueBtn" href="javascript:" target="_blank">立即阅读</a>','<a attr="inner:addToBookshelfBtn;click:addToBookshelf;" href="javascript:">加入书架</a>','</p>','</div>'].join('');function init(getWeekRecommendAjaxUrl,getGirlRecommendAjaxUrl,getBoutiqueAjaxUrl,getUserBoxAjaxUrl,getBookInfoAjaxUrl){_params.getWeekRecommendAjaxUrl=getWeekRecommendAjaxUrl||'';_params.getGirlRecommendAjaxUrl=getGirlRecommendAjaxUrl||'';_params.getBoutiqueAjaxUrl=getBoutiqueAjaxUrl||'';_params.getUserBoxAjaxUrl=getUserBoxAjaxUrl||'';_params.getBookInfoAjaxUrl=getBookInfoAjaxUrl||'';_nodes.firstWrap=$('#firstWrap');_nodes.secondWrap=$('#secondWrap');_nodes.wrap=$('.wrap');_setTopBanner()
_bindTabEvent();_bindEvent();_updateUserBox();}
function _setTopBanner(){var nowTime=new Date().getTime(),endTime=new Date('2018-9-14 08:00').getTime(),cookieName='index_topBanner';if(nowTime>endTime){return;}
if($.cookie(cookieName)==1){return;}
var tpl=['<div id="topBanner" style="width:1200px; height:550px; overflow:hidden; margin:0 auto;">','<img src="//qidian.gtimg.com/pc_top_img/top_big_img.jpg" style="width:100%; height:550px;" alt="写出好网文，传播正能量">','</div>'].join('');$(document.body).prepend(tpl);setTimeout(function(){$('#topBanner').hide();},5000);$.cookie(cookieName,1,{expires:1,path:'/'});}
function _bindEvent(){$('#myFocus').imageSliderByThumb();$('#girlFocus').imageSliderByNum({'auto':true});$('#qqQrCode').css({'position':'fixed','top':'230px'});_updateQQqrCodePosition();$(window).on('resize',_updateQQqrCodePosition);var $jingpinRecommendBox=$('#gundiv');$jingpinRecommendBox.kxbdSuperMarquee({distance:660,scrollSize:$jingpinRecommendBox.find('ul li').length*88+132,time:4,btnGo:{right:'#jingpinRecommendLeftBtn',left:'#jingpinRecommendRightBtn'},direction:'left'});$jingpinRecommendBox.on('mouseenter','ul li',function(){$(this).addClass('recAct').siblings('li').removeClass();});$("#mini_QR").hover(function(){$("#QR_code").show();},function(){$("#QR_code").hide();});$('.qiangtui').on('mouseover','ul a',function(){var bid=$(this).attr('bid');if(!bid){return;}
var targetNode=this;_bookPopup.isAllowHide=0;if(_bookPopup.setTimeoutByClose){clearTimeout(_bookPopup.setTimeoutByClose);}
if(_bookPopup.setTimeoutByOpen){clearTimeout(_bookPopup.setTimeoutByOpen);}
_bookPopup.setTimeoutByOpen=setTimeout(function(){_openBookInfoPopup(bid,targetNode);},_bookPopup.openTimeout);}).on('mouseout','a',function(){_bookPopup.isAllowHide=1;_closeBookInfoPopup();});$('#changWeekRecommendBtn').on('click',function(){_changQiangtui($(this).parent().prev('ul'),'week');return false;});$('#changGirlRecommendBtn').on('click',function(){_changQiangtui($(this).parent().prev('ul'),'girl');return false;});var $boutiqueBox=$('#boutiqueBox');$('#changeBoutiqueBtn').on('click',function(){_changeBoutique($boutiqueBox);return;});}
function _bindTabEvent(){var tabConfig=[{'tabList':_nodes.firstWrap.find(".tabid"),'tabItem':'h3','tabCurCss':'choice','eventType':'click','contentList':_nodes.firstWrap.find(".tabid"),'contentItem':"div"},{'tabList':_nodes.secondWrap.find(".tab_subtab"),'tabItem':'h3','tabCurCss':'subtab_cur','eventType':'click','contentList':_nodes.secondWrap.find(".tab_subtabdiv_box"),'contentItem':"div"},{'tabList':_nodes.secondWrap.find(".tabid"),'tabItem':'h3','tabCurCss':'choice','eventType':'click','contentList':_nodes.secondWrap.find(".tabid"),'contentItem':"div"},{'tabList':$(".tab_subtab2"),'tabItem':'h3','tabCurCss':'subtab_cur2','eventType':'click','contentList':$(".girl_rank_box"),'contentItem':"div"},{'tabList':$("#month_tab"),'tabItem':'span','tabCurCss':'new_cur','eventType':'click','contentList':$("#monthrank"),'contentItem':"div"},{'tabList':$("#salesTab"),'tabItem':'span','tabCurCss':'act','eventType':'click','contentList':$("#salesListWrap"),'contentItem':"div"},{'tabList':$(".update_tit"),'tabItem':'li','tabCurCss':'hover','eventType':'mouseover','contentList':$("#update_tab"),'contentItem':"div"}];var currentIndex=0;$(tabConfig).each(function(index,config){if(config.tabList){config.tabList.on(config.eventType,config.tabItem,function(){currentIndex=config.tabList.find(config.tabItem).index(this);$(this).addClass(config.tabCurCss).siblings(config.tabItem).removeClass(config.tabCurCss);config.contentList.children(config.contentItem).eq(currentIndex).show().siblings(config.contentItem).hide();});}});var $boutiqueBox=$('#boutiqueBox');$boutiqueBox.on('mouseover','img',function(){var $img=$boutiqueBox.find('img');$img.removeClass('bou_cur');$(this).addClass('bou_cur');$boutiqueBox.find('.boutique').eq($img.index(this)).show().siblings('.boutique').hide();});$('.popularity, .public, .sign').find('li.last').find('a').show();}
function _updateQQqrCodePosition(){$('#qqQrCode').css({'left':(_nodes.wrap.width()+_nodes.wrap.offset().left+10)+'px'});}
function _changQiangtui($target,type){if(!$target||$target.length===0||!_recommendList[type]){return;}
if(_recommendList[type]&&_recommendList[type].length>0){_changeHtml($target,_recommendList[type],1);return;}
var requestUrl=type==='week'?_params.getWeekRecommendAjaxUrl:_params.getGirlRecommendAjaxUrl;if(_isChanging.qiangtui){return;}
_isChanging.qiangtui=1;_util.request({type:"GET",dataType:'json',url:requestUrl,data:{},success:function(json){if(!json){return;}
if(json.status){if('data'in json&&json.data.list){_recommendList[type]=json.data.list;_changeHtml($target,_recommendList[type],1);}}else{if(json.info){_dialog.alert(json.info);}}},error:function(){},complete:function(){_isChanging.qiangtui=0;}});}
function _changeBoutique($target){if(!$target||$target.length===0){return;}
if(_boutiqueList&&_boutiqueList.length>0){_changeHtml($target,_boutiqueList,1);return;}
if(_isChanging.boutique){return;}
_isChanging.boutique=1;_util.request({type:"GET",dataType:'json',url:_params.getBoutiqueAjaxUrl,data:{},success:function(json){if(!json){return;}
if(json.status){if('data'in json&&json.data.list){_boutiqueList=json.data.list;_changeHtml($target,_boutiqueList,1);}}else{if(json.info){_dialog.alert(json.info);}}},error:function(){},complete:function(){_isChanging.boutique=0;}});}
function _changeHtml($target,list,count){if(!$target||!list||list.length===0||!count){return;}
var totalCount=list.length,arrTemp=[],arrTpl=[],index=0;for(var i=0;i<totalCount;i++){arrTemp.push(list[i]);}
for(var j=0;j<count;j++){if(arrTemp.length>0){index=Math.floor(Math.random()*arrTemp.length);arrTpl.push(arrTemp[index]);arrTemp.splice(index,1);}else{break;}}
$target.html(arrTpl.join(''));}
function _updateUserBox(){_util.request({type:"GET",dataType:'json',url:_params.getUserBoxAjaxUrl,data:{},success:function(json){if(!json){return;}
if(json.status){if('data'in json&&json.data.html){var $userBox=$('#userBox');$userBox.html(json.data.html);var $userTab=$userBox.find('.userActTab span');$userTab.on('click',function(){$(this).addClass('red').siblings('span').removeClass('red');$userBox.find('.userRecList').children('ul').eq($userTab.index(this)).show().siblings('ul').hide();});}}},error:function(json){}});}
function _openBookInfoPopup(bid,targetNode){if(!bid){return;}
if(bid in _bookPopup.dataList){_createBookInfoPopup(_bookPopup.dataList[bid],targetNode);return;}
if(_bookPopup.isLoading){return;}
_bookPopup.isLoading=1;_util.request({type:"GET",dataType:'json',url:_params.getBookInfoAjaxUrl,data:{'bid':bid},success:function(json){if(!json){return;}
if(json.status){if('data'in json){if(!(bid in _bookPopup.dataList)){_bookPopup.dataList[bid]=json.data;}
_createBookInfoPopup(json.data,targetNode);}}},error:function(json){},complete:function(){_bookPopup.isLoading=0;}});}
function _createBookInfoPopup(data,targetNode){if(!data){return;}
if(!_bookPopup.nodes){_bookPopup.nodes=_uiBinder.appendHTML(document.body,_util.sim2tra(_bookInfoPopupTpl),{},{'addToBookshelf':function(e,el,nodes){var bid=$(el).attr('bid');_bookshelf.addToBookshelf(bid);}});}
if(_bookPopup.nodes){var nodes=_bookPopup.nodes;$(nodes.popup).on('mouseover',function(){_bookPopup.isAllowHide=0;}).on('mouseout',function(){_bookPopup.isAllowHide=1;_closeBookInfoPopup();});var emptyUrl='javascript:;';$(nodes.bookLink).add(nodes.bookNameLink).attr('href',data.novelUrl||emptyUrl);$(nodes.bookCover).attr('src',data.coverUrl||'');var title=data.title?_util.mb_cutstr(data.title,27):'';$(nodes.bookNameLink).text(title);$(nodes.authorNameLink).attr('href',data.authorUrl||emptyUrl);var authorName=data.author?_util.mb_cutstr(data.author,24):'';$(nodes.authorNameLink).text(authorName);$(nodes.popularValue).text(data.popularity||0);var lastChapterName=data.lastChapterName?_util.mb_cutstr(data.lastChapterName,20):'';$(nodes.lastChapterName).text(lastChapterName).attr('title',data.lastChapterName||'');var bookDesc=data.intro?_util.mb_cutstr(data.intro,213):'';$(nodes.bookDesc).text(bookDesc);$(nodes.readLink).attr('href',data.dirUrl||emptyUrl);$(nodes.addToBookshelfBtn).attr('bid',data.bid||0);_setPositionByBookInfoPopup(targetNode);}}
function _setPositionByBookInfoPopup(targetNode){if(!_bookPopup.nodes||!targetNode){return;}
var nodes=_bookPopup.nodes,targetOffset=$(targetNode).offset(),targetTop=targetOffset.top,targetLeft=targetOffset.left,targetWidth=targetNode.offsetWidth,offsetTop=-30,offsetLeft=5;nodes.popup.style.top=(targetTop+offsetTop)+'px';nodes.popup.style.left=(targetLeft+targetWidth+offsetLeft)+'px';$(nodes.popup).fadeIn();}
function _closeBookInfoPopup(){if(_bookPopup.setTimeoutByOpen){clearTimeout(_bookPopup.setTimeoutByOpen);}
if(_bookPopup.setTimeoutByClose){clearTimeout(_bookPopup.setTimeoutByClose);}
_bookPopup.setTimeoutByClose=setTimeout(function(){if(_bookPopup.nodes&&_bookPopup.isAllowHide){$(_bookPopup.nodes.popup).fadeOut();}},_bookPopup.closeTimeout);}
_util.initNameSpace("CS.page.index");CS.page.index.main={"init":init};})(jQuery);﻿;(function($){var _util=CS.util,_dialog=CS.dialog,_uiBinder=CS.uiBinder;var _noLogin_titleTpl=['<h3 class="tiphead">','欢迎来到创世中文网','<a id="floatClose" title="关闭" href="javascript:;"></a>','</h3>'].join('');var _login_titleTpl=['<h3 class="tiphead">','<%= nickName %>','<img src="<%= imgUrl %>">','<a id="floatClose" title="关闭" href="javascript:;" ></a>','</h3>'].join('');var _noLogin_contentTpl=['<div class="tipFloatStyle">','<div class="tipFloatInner nobt">','<p>','立即&nbsp;<a attr="click:login;" class="red" href="javascript:;">登录</a>&nbsp;或&nbsp;','<a class="bgreen" href="<%= registerUrl %>" target="_blank">注册</a>&nbsp;，享受以下特权：','</p>','<ul class="notLogged cf">','<li>','<span class="mrqd"></span>','<p>会员成长值<br>免费领取</p>','</li>','<li>','<span class="grsj"></span>','<p>收藏您<br>喜欢的作品</p>','</li>','<li>','<span class="N_toupiao"></span>','<p>您喜爱的<br>作品和作者</p>','</li>','</ul>','</div>','</div>'].join('');var _upgrade_contentTpl=['<div class="tipFloatStyle">','<div class="tipFloatInner">','<p>欢迎您，以下是您的成长值和积分信息：</p>','<div class="u_infobox">','成长值：','<a attr="inner:pointLink;" href="<%= upgradeUrl %>" target="_blank" style="display:none;">升级&gt;&gt;</a>','<div class="expbox">','<span><%= pointValue %></span>','<div class="expwidth" style="width:<%= pointPercent %>%"></div>','</div>','</div>','<div class="u_infobox">','积&nbsp;&nbsp;分：','<a attr="inner:growthLink;" href="<%= upgradeUrl %>" target="_blank" style="display:none;">升级&gt;&gt;</a>','<div class="expbox">','<span><%= growthValue %></span>','<div class="expwidth expgreen" style="width:<%= growthPercent %>%"></div>','</div>','</div>','<div class="u_infobox"><%= yearlyMsgText %><a href="<%= yearlyUrl %>"><%= yearlyLinkText %>&gt;&gt;</a></div>','</div>','</div>'].join('');var _signIn_contentTpl=['<div class="tipFloatStyle">','<div class="tipFloatInner">','<p>欢迎您，今日签到可领取奖励</p>','<ul class="WelcomeUL cf">','<li class="P_sign">','<a href="<%= signUrl %>" title="去签到" target="_blank"></a>','</li>','</ul>','</div>','</div>'].join('');var _footerTpl=['<div class="tipPrompt">','<a attr="inner:preBtn;click:preNews;" class="Prompt_Prev" href="javascript:" title="上一个" style="display:none;"></a>','<a attr="inner:newsLink;" href="javascript:;" target="_blank"></a>','<a attr="inner:nextBtn;click:nextNews;" class="Prompt_Next" href="javascript:" title="下一个" style="display:none;"></a>','</div>'].join('');var _newsTitleList={"medal":"您有$medalCount$个待领取的徽章","msg":"您有$msgCount$条未读消息","bindQQ":"立即绑定QQ，方便又安全"};var _params={},_news=[];var _upgrade_contentNodes=null,_footerNodes=null;var _currentNewsIndex=0,_newsTitleLength=45;var _loginCookieName="rcw_login",_signCookieName="rcw_sign",_upgradeCookieName="rcw_upgrade";function init(uid,getPopupInfoAjaxUrl,userCenterUrl,msgUrl,medalUrl,imgUrl,yearlyUrl){_params.uid=uid||'0';_params.getPopupInfoAjaxUrl=getPopupInfoAjaxUrl||'';_params.userCenterUrl=userCenterUrl||'';_params.msgUrl=msgUrl||'';_params.medalUrl=medalUrl||'';_params.imgUrl=imgUrl||'';_params.yearlyUrl=yearlyUrl||'';if(_isNeedShow()){_getData();}}
function _isNeedShow(){if(_params.uid==0){if($.cookie(_loginCookieName)==="1"){return false;}}else{if($.cookie(_upgradeCookieName+_params.uid)==="1"||$.cookie(_signCookieName+_params.uid)==="1"){return false;}}
return true;}
function _getData(){_util.request({type:"GET",url:_params.getPopupInfoAjaxUrl,dataType:"json",success:function(json){if(!json){return;}
if(json.status){_createPopup(json.data);}}});}
function _createPopup(data){if(!data){return;}
var point=parseInt(data.point,10),nextPoint=parseInt(data.nextpoint,10),vipPoint=parseInt(data.vippint,10),vipNextPoint=parseInt(data.vipnextpoint,10),yearly=parseInt(data.yearly,10);var isLogin=data.uid!=0,isUpgradeMemberLevel=point>=nextPoint,isUpgradeVipLevel=vipPoint>=vipNextPoint,isToSign=data.issignin==1;if(isLogin&&!isUpgradeMemberLevel&&!isUpgradeVipLevel&&!isToSign){return;}
var popup=document.createElement("div"),closeCallback=function(){};popup.id="tipFloat";if(!isLogin){_uiBinder.appendHTML(popup,_noLogin_titleTpl);_uiBinder.appendHTML(popup,_noLogin_contentTpl,{"registerUrl":"http://zc.qq.com/chs/index.html?from=pt"},{"login":CS.login.openPopup});closeCallback=function(){$.cookie(_loginCookieName,1,{expires:1,path:'/'});};}else{var userGradeImgUrl=data.vip>0?"VIP/"+data.vip:"user/"+data.grade;_uiBinder.appendHTML(popup,_login_titleTpl,{"nickName":_util.mb_cutstr(data.nikename,33),"imgUrl":_params.imgUrl+"ico/"+userGradeImgUrl+".png"});if(isUpgradeMemberLevel||isUpgradeVipLevel){var pointPercent=point/nextPoint*100,growthPercent=vipPoint/vipNextPoint*100;pointPercent=pointPercent>100?100:Math.floor(pointPercent);growthPercent=growthPercent>100?100:Math.floor(growthPercent);var yearlyMsgText="";var yearlyLinkText="";switch(yearly){case-1:yearlyMsgText="您不是年费会员";yearlyLinkText="购买";break;case 0:yearlyMsgText="您的年会会员资格己过期";yearlyLinkText="购买";break;default:if(yearly<=5){yearlyMsgText="您的年会会员资格即将到期";}else{yearlyMsgText="您的年会会员剩余"+yearly+"天";}
yearlyLinkText="续费";}
_upgrade_contentNodes=_uiBinder.appendHTML(popup,_upgrade_contentTpl,{"pointValue":point+'/'+nextPoint,"pointPercent":pointPercent,"growthValue":vipPoint+'/'+vipNextPoint,"growthPercent":growthPercent,"upgradeUrl":_params.userCenterUrl,"yearlyMsgText":yearlyMsgText,"yearlyLinkText":yearlyLinkText,"yearlyUrl":_params.yearlyUrl});if(_upgrade_contentNodes){if(point>=nextPoint){$(_upgrade_contentNodes.pointLink).show();}
if(vipPoint>=vipNextPoint){$(_upgrade_contentNodes.growthLink).show();}}
closeCallback=function(){$.cookie(_upgradeCookieName+_params.uid,1,{expires:_getDateByNextDay(),path:'/'});};}else if(isToSign){_uiBinder.appendHTML(popup,_signIn_contentTpl,{"addPoint":data.signpoint>0?'+'+data.signpoint:'',"addGrowth":data.signvippint>0?'+'+data.signvippint:'',"signUrl":_params.userCenterUrl});closeCallback=function(){$.cookie(_signCookieName+_params.uid,1,{expires:_getDateByNextDay(),path:'/'});};}
_footerNodes=_uiBinder.appendHTML($(popup).find(".tipFloatStyle"),_footerTpl,{},{"preNews":_preNews,"nextNews":_nextNews});if(_footerNodes){var newsUrl=data.newsurl,newsTitle=data.newstitle;if(data.medalnum>0){_news.push({"title":_newsTitleList.medal.replace("$medalCount$",data.medalnum),"url":_params.medalUrl});}
if(data.msgnum>0){_news.push({"title":_newsTitleList.msg.replace("$msgCount$",data.msgnum),"url":_params.msgUrl});}
if(data.isbind===1){_news.push({"title":_newsTitleList.bindQQ,"url":_params.userCenterUrl});}
if(_news.length>0){newsUrl=_news[0].url;newsTitle=_news[0].title;if(_news.length>1){$(_footerNodes.preBtn).css("display","inline-block");$(_footerNodes.nextBtn).css("display","inline-block");}}
if(newsUrl&&newsTitle){$(_footerNodes.newsLink).attr("href",newsUrl).html(_util.mb_cutstr(newsTitle,_newsTitleLength));}}}
$(document.body).append(popup);$.fn.popWin({"popupSelector":"#tipFloat","closeSelector":"#floatClose","closeCallback":closeCallback,"slideTime":600});}
function _preNews(e,el,nodes){if(_news.length===0){return false;}
_currentNewsIndex--;if(_currentNewsIndex<0){_currentNewsIndex=_news.length-1;}
var newsUrl=_news[_currentNewsIndex].url,newsTitle=_news[_currentNewsIndex].title;$(_footerNodes.newsLink).attr("href",newsUrl).html(_util.mb_cutstr(newsTitle,_newsTitleLength));}
function _nextNews(e,el,nodes){if(_news.length===0){return false;}
_currentNewsIndex++;if(_currentNewsIndex>=_news.length){_currentNewsIndex=0;}
var newsUrl=_news[_currentNewsIndex].url,newsTitle=_news[_currentNewsIndex].title;$(_footerNodes.newsLink).attr("href",newsUrl).html(_util.mb_cutstr(newsTitle,_newsTitleLength));}
function _getDateByNextDay(){var t=new Date();t.setDate(t.getDate()+1);t.setHours(0);t.setMinutes(0);t.setSeconds(0);return t;}
CS.util.initNameSpace("CS.page.index");CS.page.index.popup={"init":init};})(jQuery);